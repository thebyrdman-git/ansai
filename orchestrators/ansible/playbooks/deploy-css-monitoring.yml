---
- name: Deploy CSS Error Monitoring System
  hosts: miraclemax.local
  become: yes
  
  pre_tasks:
    - name: Display deployment banner
      debug:
        msg:
          - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          - "ğŸ¨ CSS ERROR MONITORING DEPLOYMENT"
          - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          - ""
          - "Deploying comprehensive CSS error detection:"
          - "  âœ“ Template validation (missing files, broken references)"
          - "  âœ“ CSS syntax validation (braces, colors, syntax)"
          - "  âœ“ Runtime error monitoring (404s, CORS, fonts)"
          - "  âœ“ Automated email alerts"
          - "  âœ“ Integration with self-healing infrastructure"
          - ""
          - "Target: miraclemax.local"
          - "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

  roles:
    - css_error_monitoring

  post_tasks:
    - name: Verify timers are running
      shell: systemctl list-timers | grep -E '(css-validation|css-runtime-monitor)'
      register: timer_status
      changed_when: false

    - name: Display timer status
      debug:
        msg: "{{ timer_status.stdout_lines }}"
      when: timer_status.stdout_lines is defined

